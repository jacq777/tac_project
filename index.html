<!DOCTYPE html>
<html>
<head>
    <title>Minibus Booking</title>
<style>
        .required::after {
            content: " *";
            color: red;
        }
    </style>
    <script type="text/javascript" src="https://cdn.emailjs.com/dist/email.min.js"></script>
    <script type="text/javascript">
        (function() {
            emailjs.init("0szzn0D--PYhazodd");  // Replace with your Public Key
        })();
    </script>
</head>
<body>
    <h1>Minibus Booking System</h1>
    <form id="bookingForm" onsubmit="return validateForm(event)">
        <label for="name" class="required">Name:</label>
        <input type="text" id="name" name="name" required><br><br>
        <label for="date" class="required">Date:</label>
        <input type="date" id="date" name="date" required><br><br>
        <label for="category" class="required">Category:</label>
        <select id="category" name="category" required>
            <option value="Training trip">Training trip</option>
            <option value="Vets">Vets</option>
            <option value="Road Relays">Road Relays</option>
            <option value="YDL">YDL</option>
            <option value="NL">NL</option>
            <option value="KYAL">KYAL</option>
            <option value="XC">XC</option>
            <option value="Other">Other</option>
        </select><br><br>
        <label for="passenger_list" class="required">Passenger List:</label><br>
        <input type="text" name="passenger_1" placeholder="Passenger 1" required><br>
        <input type="text" name="passenger_2" placeholder="Passenger 2"><br>
        <input type="text" name="passenger_3" placeholder="Passenger 3"><br>
        <input type="text" name="passenger_4" placeholder="Passenger 4"><br>
        <input type="text" name="passenger_5" placeholder="Passenger 5"><br>
        <input type="text" name="passenger_6" placeholder="Passenger 6"><br>
        <input type="text" name="passenger_7" placeholder="Passenger 7"><br>
        <input type="text" name="passenger_8" placeholder="Passenger 8"><br>
        <input type="text" name="passenger_9" placeholder="Passenger 9"><br>
        <input type="text" name="passenger_10" placeholder="Passenger 10"><br>
        <input type="text" name="passenger_11" placeholder="Passenger 11"><br>
        <input type="text" name="passenger_12" placeholder="Passenger 12"><br>
        <input type="text" name="passenger_13" placeholder="Passenger 13"><br>
        <input type="text" name="passenger_14" placeholder="Passenger 14"><br>
        <input type="text" name="passenger_15" placeholder="Passenger 15"><br>
        <input type="text" name="passenger_16" placeholder="Passenger 16"><br>
        <input type="text" name="passenger_17" placeholder="Passenger 17"><br>
        <!-- Add more input fields as needed -->
        <br>
        <label for="mileage_start" class="required">Mileage at Start:</label>
        <input type="number" id="mileage_start" name="mileage_start" required><br><br>
        <label for="mileage_finish" class="required">Mileage at Finish:</label>
        <input type="number" id="mileage_finish" name="mileage_finish" required><br><br>
        <label for="fuel_added" class="required">Fuel Added in Litres:</label>
        <input type="number" id="fuel_added" name="fuel_added" required><br><br>
        <label for="incidents">Incidents:</label>
        <textarea id="incidents" name="incidents" rows="4" cols="50"></textarea><br><br>
        <label for="damage_issues">Damage Issues:</label>
        <textarea id="damage_issues" name="damage_issues" rows="4" cols="50"></textarea><br><br>
        <input type="submit" value="Book" onclick="sendEmail(event)">
    </form>

    <script type="text/javascript">
        function validateForm(event) {
            const form = document.getElementById("bookingForm");
            if (!form.checkValidity()) {
                event.preventDefault();  // Prevent form submission
                alert("Please fill in all required fields.");
                return false;
            }

            return validateMileage();  // Check mileage after form fields
        }

        function validateMileage() {
            const start = document.getElementById("mileage_start").value;
            const finish = document.getElementById("mileage_finish").value;
            if (finish && parseInt(finish) < parseInt(start)) {
                alert("Mileage at Finish cannot be less than Mileage at Start.");
                return false;  // Prevent form submission
            }
            return true;  // Allow form submission
        }

        function sendEmail(event) {
            if (!validateForm(event)) {
                return;
            }
            event.preventDefault();  // Prevent form submission
            emailjs.sendForm('service_jbulmm8', 'template_awcvemj', '#bookingForm')
                .then(function(response) {
                    alert('Booking email sent successfully!');
                }, function(error) {
                    alert('Failed to send booking email: ' + JSON.stringify(error));
                });
        }
    </script>
</body>
</html>
